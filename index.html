<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">

<meta name="description" content="متجر إلكتروني متكامل بتجربة مستخدم فريدة">
<meta name="keywords" content="متجر, تسوق, شراء, عروض">
<meta name="author" content="متجرك">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet"/>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  
  <!-- استبدال رابط Leaflet بـ CDN صحيح -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" 
        integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" 
        crossorigin=""/>

  <title>متجر إليكتروني</title>

  <link rel="stylesheet" href="theme.css">
  <link rel="stylesheet" href="style.css">

  <script>
  (function(){
    const html = document.documentElement;
    // التأكد من وجود ثيم افتراضي
    let savedTheme = localStorage.getItem('theme');
    if (!savedTheme || !['wine', 'day', 'sunset', 'coffee'].includes(savedTheme)) {
      savedTheme = 'wine'; // الثيم الافتراضي
      localStorage.setItem('theme', savedTheme);
    }
    html.classList.add(`theme-${savedTheme}`);
    html.style.visibility = 'visible';
    
    // تهيئة متغير الثيم عالمياً
    window.currentTheme = savedTheme;
  })();
</script>

</head>

<body>
  
  <div id="loading-screen">
  <div class="loading-container">
    <div class="loading-logo">
      <i class="fas fa-store"></i>
    </div>
    <div class="loading-progress-container">
      <div class="loading-progress-bar">
        <div class="loading-progress-fill"></div>
      </div>
      <div class="loading-progress-text">0%</div>
    </div>
    <div class="loading-message">جاري التحميل...</div>
    <div class="loading-dots">
      <span></span>
      <span></span>
      <span></span>
    </div>
  </div>
  </div>

  <header id="navsec">
    <nav id="nav">
     <div id="nav-btn">
        <button id="toggle-home-btn" class="nav-btn__item">
          <i class="fas fa-home"></i>
          <span id="home-label" data-i18n="home">الرئيسية</span>
        </button>
        <button id="toggle-projects-btn" class="nav-btn__item" aria-label="Show Projects">
          <i class="fas fa-store"></i>
          <span id="projects-label" data-i18n="prjct">المتجر</span>
        </button>
        <button id="language-toggle" class="nav-btn__item" aria-label="Toggle Language">
          <i class="fas fa-language"></i>
          <span id="language-label" data-i18n="ar">ar</span>
        </button>
        <button id="theme-toggle" class="nav-btn__item" aria-label="Toggle Mode">
          <i class="fas fa-moon"></i>
          <span id="theme-label" data-i18n="theme">الثيم</span>
        </button>
      </div>
    </nav>
  </header>

  <!-- باقي محتوى الصفحة هنا -->
  <section id="welcomeSection" class="main-section">
    <div class="welcome-text" id="typing-container"></div>
  </section>

  <section id="promotionsSection" class="main-section">
    <div class="sec-h1">
      <h1 data-i18n="promo_title">العروض</h1>
    </div>
    <div id="promotionsContainer" class="promotions-container">
      <!-- سيتم ملؤه ديناميكياً بالعروض -->
    </div>
  </section>
  
  <section id="botsection" class="bot-sec main-section">
    <div class="sec-h1">
      <h1 data-i18n="both1">تسوق معي</h1>
    </div>
  
    <div class="chat-container">
      <div class="chat-header">
        <div class="bot-avatar">
          <img src="bot-avatar.png" alt="Avatar">
        </div>
        <div class="bot-info">
          <span id="bot-name" data-i18n="botname">شوبو</span>
          <div class="bot-status">
            <span class="status-dot"></span>
            <span data-i18n="online">متصل الآن</span>
          </div>
        </div>
      </div>
      <div id="chatBox" class="chat-box"></div>
      <div class="chat-footer">
        <div class="input-wrapper">
          <div class="input-group">
            <button id="voice-btn" class="voice-btn" aria-label="التحدث">
              <i class="fas fa-microphone"></i>
            </button>
            
            <input type="text" id="userInput" class="chat-input" 
             data-placeholder-ar="كلمني . . ."
             data-placeholder-en="Talk to me..."
             placeholder="كلمني . . ."
             data-i18n-placeholder="chat_placeholder">

            <button id="send-btn" onclick="sendBotMessage()" class="send-btn">
              <i class="fas fa-paper-plane"></i>
            </button>
          </div>
        </div>
        <div class="quick-suggestions"></div>
      </div>
    </div>
  </section>

  <!-- باقي أقسام الموقع -->
  <section id="aboutSection" class="content-section about-section main-section">
    <div class="container">
      <div class="sec-h1">
        <h1 data-i18n="abouth1">قصتنا</h1>
      </div>
      <div id="aboutContent"></div>
    </div>
  </section>

  <section id="faqSection" class="faq-section main-section">
    <div class="sec-h1">
      <h1 data-i18n="faqh1">سؤال و جواب</h1>
    </div>
    <div id="faqList"></div>
    <div id="answerBox" class="answer-container">
      <div class="answer-content" data-i18n="faqansr"></div>
    </div>
  </section>

  <section id="servicesSection" class="main-section">
    <div class="sec-h1">
      <h1 data-i18n="servicesh1">خدماتنا</h1>
    </div>
    <div id="servicesGrid" class="services-grid"></div>
  </section>

  <section id="contactSection" class="contact-section main-section">
    <div class="sec-h1">
      <h1 data-i18n="contacth1">تابعنا علي</h1>
    </div>
    <div id="contactGrid" class="contact-grid"></div>
  </section>

  <section id="quickContactSection" class="main-section">
    <div class="sec-h1">
      <h1 data-i18n="quickh1">خدمه العملاء</h1>
    </div>
    <form id="quickContactForm" class="quick-contact-form">
      <div class="form-group">
        <label for="qcName" data-i18n="quick_name_label">الاسم</label>
        <input type="text" id="qcName" placeholder="" data-i18n-placeholder="quick_name_placeholder" required>
      </div>
      <div class="form-group">
        <label for="qcContact" data-i18n="quick_contact_label">الرقم/الإيميل</label>
        <input type="text" id="qcContact" placeholder="" data-i18n-placeholder="quick_contact_placeholder" required>
      </div>
      <div class="form-group">
        <label for="qcMessage" data-i18n="quick_message_label">الرسالة</label>
        <textarea id="qcMessage" rows="4" placeholder="" data-i18n-placeholder="quick_message_placeholder" required></textarea>
      </div>

      <div class="qc-buttons">
        <button type="button" id="qcSubmit">
          <i class="fas fa-paper-plane"></i>
          <span data-i18n="send_message">إرسال الرسالة</span>
        </button>
      </div>

      <div id="qcUserMessageBox" class="message-box" aria-live="polite"></div>
    </form>
  </section>

  <section id="statsSection" class="main-section">
    <div class="sec-h1">
      <h1 data-i18n="statsh1">احصائياتنا</h1>
    </div>
    <div id="statsGrid" class="stats-grid"></div>
  </section>

  <section id="portfolioSection" class="main-section">
    <div class="search-container">
      <div class="search-box">
        <div class="search-input-group">
          <button id="voiceSearchBtn" class="voice-btn"><i class="fas fa-microphone"></i></button>
          
          <input type="text" id="searchName" 
           data-placeholder-ar="بتدور علي ايه . . ."
           data-placeholder-en="What are you looking for..."
           placeholder="بتدور علي ايه . . .">

          <button id="searchBtn" class="search-btn"><i class="fas fa-search"></i></button>
        </div>
        
        <div class="filters-row">
          <select id="propertyType" class="filter-select">
            <option data-i18n="all" value="all">الكل</option>
          </select>
          
          <input type="number" id="priceValue" 
                 data-placeholder-ar="ادخل السعر"
                 data-placeholder-en="Enter price"
                 placeholder="ادخل السعر" 
                 min="0" 
                 class="filter-input">
          
          <select id="priceCondition" class="filter-select">
            <option data-i18n="greater" value="greater">أكثر من</option>
            <option data-i18n="less" value="less">أقل من</option>
          </select>
        </div>
      </div>
      
      <div id="portfolioGrid" class="portfolio-grid"></div>
    </div>
  </section>

  <!-- Shopping Cart Icon -->
  <div id="cart-icon-container">
    <i class="fas fa-shopping-bag"></i>
    <span id="cart-count">0</span>
  </div>

  <!-- Cart Popup -->
  <div id="cart-popup" class="hidden">
    <div class="cart-header">
      <h3 data-i18n="cart_title">سلة المشتريات</h3>
      <button id="close-cart">&times;</button>
    </div>
    
    <div id="cart-items" class="cart-items"></div>
    
    <div class="cart-footer">
      <div class="cart-total">
        <span data-i18n="cart_total">الإجمالي=</span>
        <span id="cart-total-price">0</span>
        <span data-i18n="dollar">جنيه</span>
      </div>
      <button id="checkout-btn" data-i18n="cart_checkout">تأكيد الطلب</button>
    </div>
  </div>

<div id="checkout-form-popup" class="hidden">
  <div class="checkout-header">
    <h3 data-i18n="checkout_title">تأكيد الطلب</h3>
    <button id="close-checkout">&times;</button>
  </div>
  
  <form id="checkout-form">
    <!-- الخطوة 1: المعلومات الأساسية -->
    <div id="checkout-step1">
      <!-- الحقول الحالية -->
      <div class="form-group">
        <label for="checkout-name" data-i18n="checkout_name">الاسم</label>
        <div class="checkout-input-group">
          <i class="fas fa-user input-icon"></i>
          <input type="text" id="checkout-name" required>
        </div>
      </div>
      
      <!-- حقل الهاتف -->
      <div class="form-group">
        <label for="checkout-phone" data-i18n="checkout_phone">رقم الهاتف</label>
        <div class="checkout-input-group">
          <i class="fas fa-phone input-icon"></i>
          <input type="tel" id="checkout-phone" required>
        </div>
      </div>
      
      <!-- حقل الرسالة -->
      <div class="form-group">
        <label for="checkout-message" data-i18n="checkout_message">الرسالة (اختياري)</label>
        <div class="checkout-input-group">
          <i class="fas fa-comment input-icon"></i>
          <textarea id="checkout-message" rows="3"></textarea>
        </div>
      </div>

      <!-- حقل الموقع -->
      <div class="form-group">
        <label for="checkout-location" data-i18n="checkout_location">الموقع (اختياري)</label>
        <div class="checkout-input-group">
          <i class="fas fa-location-dot input-icon"></i>
          <input type="text" id="checkout-location" 
            data-i18n-placeholder="location_placeholder"
            placeholder="">
        </div>
        <button type="button" id="get-location-btn" class="checkout-location-btn">
          <i class="fas fa-location-dot"></i>
          <span data-i18n="get_location">الحصول على الموقع</span>
        </button>
      </div>
      <!-- حقل طريقة الدفع -->
      <div class="form-group">
        <label for="payment-method" data-i18n="payment_method">طريقة الدفع</label>
        <div class="payment-methods">
          <div class="payment-option selected" data-method="cash">
            <i class="fas fa-money-bill-wave"></i>
            <span data-i18n="payment_cash">الدفع عند الاستلام</span>
          </div>
          <div class="payment-option" data-method="paymob">
            <i class="fas fa-credit-card"></i>
            <span data-i18n="payment_paymob">الدفع بالبطاقة</span>
          </div>
        </div>
      </div>
    </div>

    <div id="checkout-step2" class="hidden">
      <div class="payment-form">
        <div class="form-group">
  <label for="card-number" data-i18n="card_number">رقم البطاقة</label>
  <div class="checkout-input-group">
    <i class="fas fa-credit-card input-icon"></i>
    <input type="text" id="card-number" 
           data-placeholder-ar="1234 5678 9012 3456"
           data-placeholder-en="1234 5678 9012 3456"
           placeholder="1234 5678 9012 3456" 
           maxlength="19">
  </div>
</div>
        
<div class="two-columns">
  <div class="form-group">
    <label for="expiry-date" data-i18n="expiry_date">تاريخ الانتهاء</label>
    <div class="checkout-input-group">
      <i class="fas fa-calendar-alt input-icon"></i>
      <input type="text" id="expiry-date" 
             data-placeholder-ar="MM/YY"
             data-placeholder-en="MM/YY"
             placeholder="MM/YY" 
             maxlength="5">
    </div>
  </div>
  
  <div class="form-group">
    <label for="cvv" data-i18n="cvv">CVV</label>
    <div class="checkout-input-group">
      <i class="fas fa-lock input-icon"></i>
      <input type="text" id="cvv" 
             data-placeholder-ar="123"
             data-placeholder-en="123"
             placeholder="123" 
             maxlength="3">
    </div>
  </div>
</div>
      </div>
    </div>

    <div class="checkout-buttons">
      <button type="button" id="confirm-checkout" class="checkout-confirm-btn">
        <i class="fas fa-check-circle"></i>
        <span data-i18n="confirm_order">تأكيد الطلب</span>
      </button>
    </div>

  </form>
</div>

  <div id="overlay" class="hidden"></div>

  <div id="global-toast" class="qc-toast"></div>
  
  <!-- تحميل مكتبات JavaScript بالترتيب الصحيح -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
          integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
          crossorigin=""></script>
  
  <!-- استخدام إصدار مضغوط من Control.Geocoder -->
  <script src="https://unpkg.com/leaflet-control-geocoder@2.4.0/dist/Control.Geocoder.min.js"></script>

  <!-- تحميل Firebase -->
  <script defer src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
  <script defer src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js"></script>

  <!-- تحميل البرامج النصية الخاصة بالتطبيق -->
  <script type="module" src="theme.js"></script>
  <script type="module" src="i18n.js"></script>
  <script type="module" src="script.js"></script>
</body>
</html>